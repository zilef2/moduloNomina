import{B as C,v as E,k as aa,f as w,a as t,w as k,o as D,b as m,d as j,t as x,u as l,g as H,au as ea,q as ra,bo as la,c as q,n as Y,e as sa}from"./app-1163a5a6.js";import{_ as oa,a as na}from"./SecondaryButton-1c05a758.js";import{_ as V}from"./InputError-a6fa3c9e.js";import{_ as b,a as p}from"./TextInput-e3d3e8ef.js";import{_ as P}from"./PrimaryButton-4edf888a.js";import{_ as ia}from"./SelectInput-80e572af.js";import{Z}from"./main-e5fab067.js";import{a as ta}from"./app-57141eb6.js";const da={class:"space-y-6"},ua=["onSubmit"],ca={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ma={class:"my-6 grid grid-cols-1 md:grid-cols-2 gap-6"},_a={class:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-6"},fa={key:0,class:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-6"},ga={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ha={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ba={class:"mt-4"},pa={key:3,class:""},va=m("label",{class:"dark:text-white"},"Horario",-1),ya={class:"my-6"},Da=["disabled","error"],xa={class:"flex justify-end"},Ia={__name:"Edit",props:{show:Boolean,title:String,Reporte:Object,valoresSelect:Object,showUsers:Object,correccionUsuario:Boolean},emits:["close"],setup(M,{emit:U}){const f=M;let J=new Date().getFullYear(),X=ta.getHolidaysByYear(J),R=C(null);const S=48,G=22,T=9;let y="",_,h,$=0;const a=E({fecha_ini:"",fecha_fin:"",horas_trabajadas:"",centro_costo_id:"",observaciones:"",almuerzo:"",valido:"",diurnas:0,nocturnas:0,extra_diurnas:0,extra_nocturnas:0,dominicales:"no",extra:"no",esFestivo:!1,dominical_diurnas:0,dominical_nocturnas:0,dominical_extra_diurnas:0,dominical_extra_nocturnas:0}),F=()=>{var o;a.almuerzo=$,f.correccionUsuario?a.valido=0:a.valido=2;//! todo 
a.horas_trabajadas<=48?a.put(route("Reportes.update",(o=f.Reporte)==null?void 0:o.id),{preserveScroll:!0,onSuccess:()=>{U("close"),a.reset()},onError:()=>null,onFinish:()=>null}):alert("Demasiadas horas")};function B(o){let r,e,n,s,d=!1;var g={};let c=Math.floor(o.getDate()),i=o.getMonth();try{X.forEach(u=>{if(e=u.date.split("/"),r=new Date(e[2],e[1]-1,e[0]),n=Math.floor(r.getDate()),s=r.getMonth(),n===c&&s===i)throw d=!0,g})}catch{}return d}function K(o,r,e){a.dominical_diurnas=a.diurnas,a.dominical_extra_diurnas=a.extra_diurnas;const n=parseInt(o.getHours());if(n<=6)a.diurnas=0,a.extra_diurnas=0,a.nocturnas==0?(a.dominical_nocturnas=a.nocturnas-n,a.nocturnas=n):(a.dominical_extra_nocturnas=a.extra_nocturnas-n,a.extra_nocturnas=n);else{a.nocturnas==0?(a.dominical_extra_nocturnas=h,a.extra_nocturnas=_):(a.dominical_nocturnas=h,a.nocturnas=_-a.extra_nocturnas);const s=Math.abs(n-6);a.diurnas==0?(a.dominical_extra_diurnas=a.extra_diurnas-s,a.extra_diurnas=s):(a.dominical_diurnas=a.diurnas-s,a.diurnas=s)}}function Q(o,r,e,n){const s=parseInt(o.getHours()),d=parseInt(r.getHours());e!==null?e<6?(a.dominical_extra_nocturnas=_-e,a.extra_nocturnas-=a.dominical_extra_nocturnas,a.dominical_nocturnas=e,a.nocturnas-=e,a.dominical_diurnas=0,a.dominical_extra_diurnas=d>6?d-6:0,a.extra_diurnas-=a.dominical_extra_diurnas,console.log("camino1")):n?(a.dominical_nocturnas=_,a.nocturnas=h,a.dominical_diurnas=e-6,a.dominical_extra_diurnas=d-e,a.diurnas=0,a.extra_diurnas=0,console.log("camino2")):(a.dominical_extra_nocturnas=_,a.extra_nocturnas-=_,a.dominical_nocturnas=0,a.dominical_diurnas=0,console.log("camino3"),d>6&&(a.dominical_extra_diurnas=d-6,a.extra_diurnas-=a.dominical_extra_diurnas)):(a.dominical_nocturnas=_,a.nocturnas-=_,s>=21?(a.dominical_diurnas=parseInt(a.diurnas),a.diurnas=0):(a.diurnas=21-s,a.dominical_diurnas=d>6?d-6:0),console.log("camino4 sin extras"))}function W(o,r,e,n){let s=B(new Date(o)),d=B(new Date(r));console.log("ini festivo - fin festivo :",s,d),o.getDay()==0||r.getDay()==0?(a.dominicales="si",y="Dominical",(s||d)&&(y=" y festivo")):s||d?(a.dominicales="si",y="Festivo"):a.dominicales="no",o.getDay()==0&&r.getDay()==0||s||d?(a.dominical_diurnas=a.diurnas,a.diurnas=0,a.dominical_nocturnas=a.nocturnas,a.nocturnas=0,a.dominical_extra_diurnas=a.extra_diurnas,a.extra_diurnas=0,a.dominical_extra_nocturnas=a.extra_nocturnas,a.extra_nocturnas=0):((o.getDay()==0||s)&&K(r),(r.getDay()==0||d)&&Q(o,r,e,n)),a.horas_trabajadas>=T&&(a.horas_trabajadas-=1,a.diurnas>0&&a.nocturnas<=a.diurnas?(a.diurnas-=1,a.almuerzo+=" diurno"):a.nocturnas>0&&a.nocturnas>a.diurnas&&(a.nocturnas-=1,a.almuerzo+=" nocturno")),console.log("Fin!")}function z(o,r){let e=new Date(o),n=new Date(r),s=null,d=!1;if(a.horas_trabajadas<T)a.almuerzo="No",a.diurnas=Math.abs(N(a.fecha_ini,a.fecha_fin,s)[1]),a.nocturnas=Math.abs(A(a.fecha_ini,a.fecha_fin,s)[1]);else{console.log("extras"),a.almuerzo=a.horas_trabajadas>8?1:0,a.almuerzo=a.horas_trabajadas>16?2:a.almuerzo,$=a.almuerzo,a.almuerzo+=" horas";let g=9;f.horasemana>S-9&&(g=f.horasemana-S,console.log("ğŸ§ˆ debu ExtrasPrematuras:",g)),s=parseInt(new Date(a.fecha_ini).getHours())+g,s>=24&&(s=24,d=!0);let c=N(a.fecha_ini,a.fecha_fin,s);a.extra_diurnas=c[0],a.diurnas=c[1];let i=A(a.fecha_ini,a.fecha_fin,s);a.extra_nocturnas=i[0],a.nocturnas=i[1]}console.log("ğŸ§ˆ ğŸ§ˆ  CuandoEmpiezaExtra:",s),W(e,n,s,d)}function N(o,r,e){const n=new Date(o).getHours(),s=new Date(r).getHours(),d=new Date(o).getDate(),g=new Date(r).getDate();let c=n>=6?n:6;if(d==g){let i=0,v=(s>=21?21:s)-c;if(v=v<0?0:v,e!==null&&e<21){let I=e-c;v>=I?(i=v-I,v=I):console.log("imposible!")}return console.log("mismo DIA, HorasExtra & ordinarias",i,v),[i,v]}else{let i=0,u=0;return s<=6?(i=c<=21?21-c:0,e!==null&&e<21&&e>6&&(c<=e,i=e-c,u=21-e)):(n<=21?i=21-n:e!==null?i=e-6:i=n==23?1:0,e!==null&&(e<=6?u=s>6?s-6:0:s>=e?u=s-e:(u=e<=21?21-e:0,u+=s>=6?s-6:0))),console.log("ğŸ§ˆğŸ§ˆğŸ§ˆ DIA HorasExtra & ordinarias",u,i),[u,i]}}function A(o,r,e){const n=new Date(o).getHours(),s=new Date(r).getHours(),d=new Date(o).getDate(),g=new Date(r).getDate();_=0,h=0,d==g?(n<6&&s<=6?_=s-n:n<6&&(_=6-n),n>=21&&s>=21?h=s-n:s>21&&(h=s-21)):(n<6&&s<=6&&n<s?_=s-n:(n<6&&(_=6-n),s<=6?_+=s:_+=6),n>=21&&s>=21?h=s-n:(s>21&&(h+=s-21),n>21?h+=24-n:h+=24-21));let c=_+h;console.log("ğŸš€ Madrugada & tarde:",_,h+" = "+c);let i=0,u=0;return e===null||typeof e>"u"?[0,c]:(e>=21?s>=21?(i=s>=e?s-e:0,u=c-i,console.log("0a : extra & noche",i,u)):(i=24-e,i+=_,u=c-i,console.log("0a : extra & noche",i,u)):e<=6?(u=e+h,i=_>=e?_-e:0,console.log("ğŸš€ 1 : extra & noche",i,u)):s>21?(i=h,u=_,console.log("ğŸ˜¶â€ğŸŒ«ï¸2  extra  ordinarias",i,u)):d==g?(i=0,u=c,console.log("ğŸ˜¶â€ğŸŒ«ï¸1  extra  ordinarias",i,u)):(u=n<6?6-n:0,i=c-u,console.log("ğŸ˜¶â€ğŸŒ«ï¸0  extra  ordinarias",i,u)),[i,u])}function L(o){const r=new Date(o),e=r.getFullYear(),n=("0"+(r.getMonth()+1)).slice(-2),s=("0"+r.getDate()).slice(-2),d=("0"+r.getHours()).slice(-2),g=("0"+r.getMinutes()).slice(-2);return`${e}-${n}-${s}T${d}:${g}`}aa(()=>{var o,r,e,n,s,d,g;if(f.show&&(a.errors={},a.fecha_ini==""&&(a.fecha_ini=L((o=f.Reporte)==null?void 0:o.fecha_ini)),a.fecha_fin==""&&(a.fecha_fin=L((r=f.Reporte)==null?void 0:r.fecha_fin)),a.centro_costo_id=(e=f.Reporte)==null?void 0:e.centro_costo_id,a.fecha_ini=(n=f.Reporte)==null?void 0:n.fecha_ini,a.fecha_fin=(s=f.Reporte)==null?void 0:s.fecha_fin,a.observaciones=(d=f.Reporte)==null?void 0:d.observaciones,a.horas_trabajadas=(g=f.Reporte)==null?void 0:g.horas_trabajadas,Date.parse(a.fecha_ini)>Date.parse(a.fecha_fin)?a.horas="0":a.horas_trabajadas=parseInt((Date.parse(a.fecha_fin)-Date.parse(a.fecha_ini))/(3600*1e3)),Date.parse(a.fecha_ini)&&Date.parse(a.fecha_fin))){let c=Date.parse(a.fecha_ini),i=Date.parse(a.fecha_fin);if(a.horas_trabajadas=0,a.almuerzo=0,a.diurnas=0,a.nocturnas=0,a.extra_diurnas=0,a.extra_nocturnas=0,a.dominical_diurnas=0,a.dominical_nocturnas=0,a.dominical_extra_diurnas=0,a.dominical_extra_nocturnas=0,a.horas_trabajadas=parseInt((i-c)/(3600*1e3)),c>i)a.errors.horas_trabajadas="La fecha inicial no debe ser posterior a la final";else if(a.horas_trabajadas>=G)a.errors.horas_trabajadas="Las horas trabajadas son demasiadas",a.horas_trabajadas="0",a.diurnas="0",a.nocturnas="0",a.almuerzo="0";else{const u=new Date(c).getDate(),v=new Date(i).getDate();u!=v?(a.errors.horas_trabajadas="Debe realizar dos reportes",a.horas_trabajadas="0",a.diurnas="0",a.nocturnas="0",a.almuerzo="0"):z(c,i)}}});const O=["Lun","Mar","Mie","Jue","Vie","Sab","Dom"];return(o,r)=>(D(),w("section",da,[t(oa,{show:f.show,onClose:r[16]||(r[16]=e=>U("close"))},{default:k(()=>[m("form",{class:"p-6",onSubmit:sa(F,["prevent"])},[m("h2",ca,[j(x(o.lang().label.edit)+" "+x(f.title)+" ",1),m("b",null,x(f.showUsers[f.Reporte.user_id]),1)]),m("div",ma,[m("div",null,[t(b,{for:"fecha_ini",value:o.lang().label.fecha_ini},null,8,["value"]),t(l(Z),{"is-24":!1,"day-names":O,"auto-apply":"",flow:["calendar","time"],"enable-time-picker":!0,teleport:!0,id:"fecha_ini",type:"date",class:"mt-1 block w-full",modelValue:l(a).fecha_ini,"onUpdate:modelValue":r[0]||(r[0]=e=>l(a).fecha_ini=e),required:"",placeholder:o.lang().placeholder.fecha_ini,error:l(a).errors.fecha_ini},null,8,["modelValue","placeholder","error"]),t(V,{class:"mt-2",message:l(a).errors.fecha_ini},null,8,["message"])]),m("div",null,[t(b,{for:"fecha_fin",value:o.lang().label.fecha_fin},null,8,["value"]),t(l(Z),{"is-24":!1,"day-names":O,"auto-apply":"",flow:["calendar","time"],"enable-time-picker":!0,teleport:!0,id:"fecha_fin",type:"date",class:"mt-1 block w-full",modelValue:l(a).fecha_fin,"onUpdate:modelValue":r[1]||(r[1]=e=>l(a).fecha_fin=e),required:"",placeholder:o.lang().placeholder.fecha_fin,error:l(a).errors.fecha_fin},null,8,["modelValue","placeholder","error"]),t(V,{class:"mt-2",message:l(a).errors.fecha_fin},null,8,["message"])]),m("div",null,[t(b,{for:"horas_trabajadas",value:o.lang().label.horas_trabajadas},null,8,["value"]),t(p,{id:"horas_trabajadas",type:"number",class:"mt-1 block w-full",modelValue:l(a).horas_trabajadas,"onUpdate:modelValue":r[2]||(r[2]=e=>l(a).horas_trabajadas=e),disabled:"",placeholder:o.lang().placeholder.horas_trabajadas,error:l(a).errors.horas_trabajadas},null,8,["modelValue","placeholder","error"]),t(V,{class:"mt-2",message:l(a).errors.horas_trabajadas},null,8,["message"])]),m("div",null,[t(b,{for:"almuerzo",value:o.lang().label.horacomida+" (+9 horas)"},null,8,["value"]),t(p,{id:"almuerzo",type:"text",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).almuerzo,"onUpdate:modelValue":r[3]||(r[3]=e=>l(a).almuerzo=e),disabled:"",placeholder:o.lang().placeholder.almuerzo,error:l(a).errors.almuerzo},null,8,["modelValue","placeholder","error"])]),m("div",_a,[m("div",null,[t(b,{ref_key:"label_diurnas",ref:R,for:"diurnas",value:o.lang().label.diurnas},null,8,["value"]),t(p,{id:"diurnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).diurnas,"onUpdate:modelValue":r[4]||(r[4]=e=>l(a).diurnas=e),disabled:"",placeholder:o.lang().placeholder.diurnas,error:l(a).errors.diurnas},null,8,["modelValue","placeholder","error"])]),m("div",null,[t(b,{ref:"label_nocturnas",for:"nocturnas",value:o.lang().label.nocturnas},null,8,["value"]),t(p,{id:"nocturnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).nocturnas,"onUpdate:modelValue":r[5]||(r[5]=e=>l(a).nocturnas=e),disabled:"",placeholder:o.lang().placeholder.nocturnas,error:l(a).errors.nocturnas},null,8,["modelValue","placeholder","error"])])]),l(a).extra_diurnas||l(a).extra_nocturnas||l(a).dominicales=="si"?(D(),w("div",fa,[m("div",null,[t(b,{ref:"label_extra_diurnas",for:"extra_diurnas",value:o.lang().label.extra_diurnas},null,8,["value"]),t(p,{id:"extra_diurnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).extra_diurnas,"onUpdate:modelValue":r[6]||(r[6]=e=>l(a).extra_diurnas=e),disabled:"",placeholder:o.lang().placeholder.extra_diurnas,error:l(a).errors.extra_diurnas},null,8,["modelValue","placeholder","error"])]),m("div",null,[t(b,{ref:"label_extra_nocturnas",for:"extra_nocturnas",value:o.lang().label.extra_nocturnas},null,8,["value"]),t(p,{id:"extra_nocturnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).extra_nocturnas,"onUpdate:modelValue":r[7]||(r[7]=e=>l(a).extra_nocturnas=e),disabled:"",placeholder:o.lang().placeholder.extra_nocturnas,error:l(a).errors.extra_nocturnas},null,8,["modelValue","placeholder","error"])])])):H("",!0),l(a).dominicales=="si"?(D(),w("div",ga,[m("div",null,[t(b,{ref_key:"label_diurnas",ref:R,for:"dominical_diurnas",value:o.lang().label.dominical_diurnas},null,8,["value"]),t(p,{id:"dominical_diurnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).dominical_diurnas,"onUpdate:modelValue":r[8]||(r[8]=e=>l(a).dominical_diurnas=e),disabled:"",placeholder:o.lang().placeholder.dominical_diurnas,error:l(a).errors.dominical_diurnas},null,8,["modelValue","placeholder","error"])]),m("div",null,[t(b,{ref:"label_nocturnas",for:"dominical_nocturnas",value:o.lang().label.dominical_nocturnas},null,8,["value"]),t(p,{id:"dominical_nocturnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).dominical_nocturnas,"onUpdate:modelValue":r[9]||(r[9]=e=>l(a).dominical_nocturnas=e),disabled:"",placeholder:o.lang().placeholder.dominical_nocturnas,error:l(a).errors.dominical_nocturnas},null,8,["modelValue","placeholder","error"])])])):H("",!0),l(a).dominicales=="si"?(D(),w("div",ha,[m("div",null,[t(b,{ref:"label_extra_diurnas",for:"dominical_extra_diurnas",value:o.lang().label.dominical_extra_diurnas},null,8,["value"]),t(p,{id:"dominical_extra_diurnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).dominical_extra_diurnas,"onUpdate:modelValue":r[10]||(r[10]=e=>l(a).dominical_extra_diurnas=e),disabled:"",placeholder:o.lang().placeholder.dominical_extra_diurnas,error:l(a).errors.dominical_extra_diurnas},null,8,["modelValue","placeholder","error"])]),m("div",null,[t(b,{ref:"label_extra_nocturnas",for:"dominical_extra_nocturnas",value:o.lang().label.dominical_extra_nocturnas},null,8,["value"]),t(p,{id:"dominical_extra_nocturnas",type:"number",class:"bg-gray-100 dark:bg-gray-700 mt-1 w-full",modelValue:l(a).dominical_extra_nocturnas,"onUpdate:modelValue":r[11]||(r[11]=e=>l(a).dominical_extra_nocturnas=e),disabled:"",placeholder:o.lang().placeholder.dominical_extra_nocturnas,error:l(a).errors.dominical_extra_nocturnas},null,8,["modelValue","placeholder","error"])])])):H("",!0),m("div",ba,[t(b,{for:"centro_costo_id",value:o.lang().label.centro_costo_id},null,8,["value"]),t(ia,{modelValue:l(a).centro_costo_id,"onUpdate:modelValue":r[12]||(r[12]=e=>l(a).centro_costo_id=e),dataSet:f.valoresSelect,class:"mt-1 block w-full"},null,8,["modelValue","dataSet"]),t(V,{class:"mt-2",message:l(a).errors.centro_costo_id},null,8,["message"])]),l(a).dominicales=="si"?(D(),w("div",pa,[va,t(p,{id:"dominicales",type:"text",class:"bg-gray-100 dark:bg-gray-700 block w-full",modelValue:l(y),"onUpdate:modelValue":r[13]||(r[13]=e=>ea(y)?y.value=e:y=e),disabled:""},null,8,["modelValue"])])):H("",!0)]),m("div",ya,[t(b,{for:"observaciones",value:o.lang().label.observaciones+" (Porque se esta rechazando)"},null,8,["value"]),ra(m("textarea",{disabled:M.correccionUsuario,id:"observaciones",type:"text","onUpdate:modelValue":r[14]||(r[14]=e=>l(a).observaciones=e),class:"mt-1 block w-full rounded-md shadow-sm dark:bg-black dark:text-white placeholder:text-gray-400 placeholder:dark:text-gray-400/50",cols:"30",rows:"3",error:l(a).errors.observaciones},`\r
                        `,8,Da),[[la,l(a).observaciones]]),t(V,{class:"mt-2",message:l(a).errors.observaciones},null,8,["message"])]),m("div",xa,[t(na,{disabled:l(a).processing,onClick:r[15]||(r[15]=e=>U("close"))},{default:k(()=>[j(x(o.lang().button.close),1)]),_:1},8,["disabled"]),M.correccionUsuario?(D(),q(P,{key:0,class:Y(["ml-3",{"opacity-25":l(a).processing}]),disabled:l(a).processing,onClick:F},{default:k(()=>[j(x(l(a).processing?"...":o.lang().button.corect),1)]),_:1},8,["class","disabled"])):(D(),q(P,{key:1,class:Y(["ml-3",{"opacity-25":l(a).processing}]),disabled:l(a).processing,onClick:F},{default:k(()=>[j(x(l(a).processing?o.lang().button.reject+"...":o.lang().button.reject),1)]),_:1},8,["class","disabled"]))])],40,ua)]),_:1},8,["show"])]))}};export{Ia as default};
